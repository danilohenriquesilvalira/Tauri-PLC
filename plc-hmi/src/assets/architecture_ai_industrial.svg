<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800" style="background-color: #f8fafc; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
  <!-- Definições de Gradientes e Filtros -->
  <defs>
    <linearGradient id="grad-backend" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1e293b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0f172a;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="grad-plc" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#94a3b8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#475569;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="grad-ai" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#7c3aed;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#4f46e5;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="grad-db" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0ea5e9;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0284c7;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#000000" flood-opacity="0.25" />
    </filter>
  </defs>

  <!-- Título -->
  <text x="600" y="50" text-anchor="middle" font-size="28" font-weight="bold" fill="#334155">Arquitetura: Assistente Virtual de Automação Industrial</text>
  <text x="600" y="80" text-anchor="middle" font-size="16" fill="#64748b">Diagnóstico Inteligente de Falhas em Eclusas</text>

  <!-- ===============================
       ZONA 1: CHÃO DE FÁBRICA (PLCs)
       =============================== -->
  <g transform="translate(50, 200)">
    <rect x="0" y="0" width="200" height="300" rx="10" fill="#e2e8f0" stroke="#cbd5e1" stroke-dasharray="5,5" />
    <text x="100" y="-15" text-anchor="middle" font-weight="bold" fill="#64748b">CAMADA FÍSICA</text>
    
    <!-- PLC 1 -->
    <g transform="translate(25, 30)">
      <rect width="150" height="60" rx="4" fill="url(#grad-plc)" filter="url(#shadow)" />
      <text x="75" y="25" text-anchor="middle" fill="white" font-weight="bold">PLC Eclusa 01</text>
      <circle cx="20" cy="30" r="4" fill="#22c55e" /> <!-- Led Verde -->
      <text x="75" y="45" text-anchor="middle" fill="#e2e8f0" font-size="10">Sensores e Atuadores</text>
    </g>
    
    <!-- PLC 2 -->
    <g transform="translate(25, 110)">
      <rect width="150" height="60" rx="4" fill="url(#grad-plc)" filter="url(#shadow)" />
      <text x="75" y="25" text-anchor="middle" fill="white" font-weight="bold">PLC Eclusa 02</text>
      <circle cx="20" cy="30" r="4" fill="#ef4444" animate="opacity;0.5;1;0.5" dur="1s" repeatCount="indefinite" /> <!-- Led Vermelho Piscando -->
      <text x="75" y="45" text-anchor="middle" fill="#e2e8f0" font-size="10">Falha Detectada</text>
    </g>

    <!-- PLC 3 -->
    <g transform="translate(25, 190)">
      <rect width="150" height="60" rx="4" fill="url(#grad-plc)" filter="url(#shadow)" />
      <text x="75" y="25" text-anchor="middle" fill="white" font-weight="bold">PLC Eclusa 03</text>
      <circle cx="20" cy="30" r="4" fill="#22c55e" />
    </g>
  </g>

  <!-- Seta Dados TCP -->
  <g transform="translate(260, 350)">
    <line x1="0" y1="0" x2="80" y2="0" stroke="#334155" stroke-width="3" marker-end="url(#arrowhead)" />
    <text x="40" y="-10" text-anchor="middle" font-size="12" font-weight="bold" fill="#334155">TCP/IP (Raw Data)</text>
  </g>

  <!-- ===============================
       ZONA 2: CORE BACKEND (RUST)
       =============================== -->
  <g transform="translate(350, 150)">
    <rect x="0" y="0" width="300" height="400" rx="12" fill="url(#grad-backend)" filter="url(#shadow)" />
    <text x="150" y="-15" text-anchor="middle" font-weight="bold" fill="#334155">CORE BACKEND (RUST)</text>
    <text x="150" y="-35" text-anchor="middle" font-size="12" fill="#64748b">Alta Performance & Confiabilidade</text>

    <!-- Módulo TCP Server -->
    <g transform="translate(25, 40)">
      <rect width="250" height="60" rx="4" fill="white" opacity="0.1" stroke="white" stroke-width="1" />
      <text x="125" y="25" text-anchor="middle" fill="white" font-weight="bold">TCP Server Engine</text>
      <text x="125" y="45" text-anchor="middle" fill="#94a3b8" font-size="11">Buffer Pool • KeepAlive • Robustez</text>
    </g>

    <!-- Seta Interna -->
    <path d="M 150 100 L 150 130" stroke="white" stroke-width="2" stroke-dasharray="4,4" />

    <!-- Smart Cache -->
    <g transform="translate(25, 130)">
      <rect width="250" height="80" rx="4" fill="#22c55e" fill-opacity="0.1" stroke="#22c55e" stroke-width="2" />
      <text x="125" y="30" text-anchor="middle" fill="#22c55e" font-weight="bold" font-size="16">Smart Cache</text>
      <text x="125" y="55" text-anchor="middle" fill="#e2e8f0" font-size="11">Estado Real Instantâneo</text>
      <text x="125" y="70" text-anchor="middle" fill="#94a3b8" font-size="10">(Sensor A: 1, Sensor B: 0...)</text>
    </g>

    <!-- Seta Interna -->
    <path d="M 150 210 L 150 240" stroke="white" stroke-width="2" stroke-dasharray="4,4" />

    <!-- WebSocket Server -->
    <g transform="translate(25, 240)">
      <rect width="250" height="60" rx="4" fill="white" opacity="0.1" stroke="white" stroke-width="1" />
      <text x="125" y="25" text-anchor="middle" fill="white" font-weight="bold">WebSocket Server</text>
      <text x="125" y="45" text-anchor="middle" fill="#94a3b8" font-size="11">Broadcast MessagePack</text>
    </g>
    
    <!-- Conexão DB -->
    <path d="M 150 300 L 150 330" stroke="#0ea5e9" stroke-width="2" />
    <circle cx="150" cy="340" r="10" fill="url(#grad-db)" /> <!-- Ponto de conexão DB -->
  </g>

  <!-- ===============================
       ZONA 3: CONHECIMENTO (DB)
       =============================== -->
  <g transform="translate(350, 600)">
    <path d="M 0 20 C 0 0 300 0 300 20 L 300 130 C 300 150 0 150 0 130 Z" fill="url(#grad-db)" filter="url(#shadow)" />
    <ellipse cx="150" cy="20" rx="150" ry="20" fill="#38bdf8" fill-opacity="0.3" />
    
    <text x="150" y="60" text-anchor="middle" fill="white" font-weight="bold" font-size="18">PostgreSQL</text>
    <text x="150" y="85" text-anchor="middle" fill="#e0f2fe" font-size="14">Knowledge Base</text>
    
    <!-- Tabelas -->
    <g transform="translate(40, 90)">
        <rect x="0" y="0" width="100" height="30" rx="4" fill="white" fill-opacity="0.2" />
        <text x="50" y="20" text-anchor="middle" fill="white" font-size="10">Regras de Falha</text>
    </g>
    <g transform="translate(160, 90)">
        <rect x="0" y="0" width="100" height="30" rx="4" fill="white" fill-opacity="0.2"/>
        <text x="50" y="20" text-anchor="middle" fill="white" font-size="10">Histórico de Tags</text>
    </g>
  </g>

  <!-- Conexão Rust -> DB -->
  <path d="M 500 550 L 500 600" stroke="#0ea5e9" stroke-width="3" stroke-dasharray="5,5" marker-end="url(#arrowhead-blue)" />

  <!-- ===============================
       ZONA 4: INTELIGÊNCIA ARTIFICIAL (Chatbot)
       =============================== -->
  <g transform="translate(800, 200)">
    <rect x="0" y="0" width="350" height="350" rx="20" fill="white" stroke="#7c3aed" stroke-width="1" filter="url(#shadow)" />
    
    <!-- Header Chat -->
    <path d="M 0 20 Q 0 0 20 0 L 330 0 Q 350 0 350 20 L 350 60 L 0 60 Z" fill="url(#grad-ai)" />
    <text x="175" y="40" text-anchor="middle" fill="white" font-weight="bold" font-size="18">Assistente IA Industrial</text>

    <!-- Conteúdo Chat -->
    <g transform="translate(20, 80)">
      <!-- Mensagem Operador -->
      <g>
        <rect x="100" y="0" width="200" height="40" rx="10" fill="#f1f5f9" />
        <text x="290" y="25" text-anchor="end" fill="#334155" font-size="12">Pq a eclusa 2 parou?</text>
        <circle cx="320" cy="20" r="15" fill="#94a3b8" />
        <text x="320" y="25" text-anchor="middle" fill="white" font-size="10">OP</text>
      </g>

      <!-- Processamento IA (Cérebro Central) -->
      <g transform="translate(10, 60)">
        <circle cx="20" cy="20" r="15" fill="url(#grad-ai)" />
        <text x="20" y="25" text-anchor="middle" fill="white" font-size="10">AI</text>
        
        <rect x="45" y="0" width="250" height="120" rx="10" fill="#f5f3ff" stroke="#ddd6fe" />
        <text x="60" y="20" fill="#7c3aed" font-size="11" font-weight="bold">Analisando Falha...</text>
        
        <!-- Passo 1 -->
        <g transform="translate(60, 35)">
           <circle cx="5" cy="5" r="3" fill="#0ea5e9" />
           <text x="15" y="9" font-size="10" fill="#475569">Busquei regra no PostgreSQL: "Falha 304"</text>
        </g>
        <!-- Passo 2 -->
        <g transform="translate(60, 55)">
           <circle cx="5" cy="5" r="3" fill="#22c55e" />
           <text x="15" y="9" font-size="10" fill="#475569">Li estado real (TCP): Tag "Sensor_B" = 0</text>
        </g>
        <!-- Conclusão -->
        <g transform="translate(60, 80)">
           <line x1="0" y1="0" x2="200" y2="0" stroke="#ddd6fe" />
           <text x="0" y="15" font-size="11" font-weight="bold" fill="#dc2626">Diagnóstico: Sensor B não atuou.</text>
           <text x="0" y="30" font-size="10" fill="#475569">Verificar cabo ou alinhamento físico.</text>
        </g>
      </g>
    </g>
  </g>

  <!-- Setas Conectoras Finais -->
  <!-- 1. Real-time Data (Rust -> AI) -->
  <path d="M 650 350 C 720 350 720 350 790 350" stroke="#22c55e" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead-green)" />
  <text x="720" y="340" text-anchor="middle" font-size="10" fill="#22c55e" font-weight="bold">Tags (Real-time)</text>

  <!-- 2. Logic Data (DB -> AI) -->
  <path d="M 650 650 C 975 650 975 650 975 560" stroke="#0ea5e9" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead-blue)" fill="none" />
  <text x="820" y="640" text-anchor="middle" font-size="10" fill="#0ea5e9" font-weight="bold">Regras & Lógica (Knowledge)</text>

  <!-- Marcadores de Seta -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#334155" />
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#22c55e" />
    </marker>
    <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#0ea5e9" />
    </marker>
  </defs>

</svg>
